<?xml version="1.0" encoding="UTF-8"?><record_update table="sys_security_acl">
    <sys_security_acl action="INSERT_OR_UPDATE">
        <active>true</active>
        <admin_overrides>true</admin_overrides>
        <advanced>true</advanced>
        <condition/>
        <description>Allow read for records in cmdb_qb_result_base, for users with roles (cmdb_query_builder, cmdb_query_builder_read), and if the ACL script returns true.</description>
        <name>cmdb_qb_result_base</name>
        <operation display_value="read">read</operation>
        <script><![CDATA[answer = (current.sys_created_by == gs.getUserName());
if (answer) {
	var fields = current.getFields();
	for (var i = 0; i < fields.size() && answer; i++) {
		var fieldName = fields.get(i).getName();
		if (fieldName.startsWith("u_rel_")) {
			var val = current.getValue(fieldName);
			var rel = new GlideRecord('cmdb_rel_ci');
			rel.get(val);
			var canRead = rel.canRead();
			answer = canRead;
		}
	}
}


]]></script>
        <sys_class_name>sys_security_acl</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2017-07-08 17:53:34</sys_created_on>
        <sys_id>3c2d10decbb73200cab07f1b734c9c75</sys_id>
        <sys_mod_count>19</sys_mod_count>
        <sys_name>cmdb_qb_result_base</sys_name>
        <sys_package display_value="Configuration Management (CMDB)" source="com.snc.cmdb">e54908b9bd1300100ed8f3f9e29d315c</sys_package>
        <sys_policy/>
        <sys_scope display_value="prb4">323bb5c2fc130010f87776523ee47a4b</sys_scope>
        <sys_update_name>sys_security_acl_3c2d10decbb73200cab07f1b734c9c75</sys_update_name>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2020-03-03 15:32:46</sys_updated_on>
        <type display_value="record">record</type>
    </sys_security_acl>
    <sys_claim action="INSERT_OR_UPDATE">
        <claim_owner_scope display_value="prb4">323bb5c2fc130010f87776523ee47a4b</claim_owner_scope>
        <claim_timestamp>170a1072c270000001</claim_timestamp>
        <metadata_update_name>sys_security_acl_3c2d10decbb73200cab07f1b734c9c75</metadata_update_name>
        <previous_claim_app_version>1.0.0</previous_claim_app_version>
        <previous_claim_name>prb4</previous_claim_name>
        <previous_claim_scope>323bb5c2fc130010f87776523ee47a4b</previous_claim_scope>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2020-03-03 15:32:46</sys_created_on>
        <sys_id>18e982caa9130010f877b9481bbf64ce</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2020-03-03 15:32:46</sys_updated_on>
    </sys_claim>
    <sys_claim action="INSERT_OR_UPDATE">
        <claim_owner_scope display_value="prb4">323bb5c2fc130010f87776523ee47a4b</claim_owner_scope>
        <claim_timestamp>170a1072c1d0000001</claim_timestamp>
        <metadata_update_name>sys_security_acl_3c2d10decbb73200cab07f1b734c9c75</metadata_update_name>
        <previous_claim_app_version>1.0.0</previous_claim_app_version>
        <previous_claim_name>com.snc.cmdb</previous_claim_name>
        <previous_claim_scope>com.snc.cmdb</previous_claim_scope>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2020-03-03 15:32:46</sys_created_on>
        <sys_id>d8e982caa9130010f877b9481bbf64ce</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2020-03-03 15:32:46</sys_updated_on>
    </sys_claim>
</record_update>
